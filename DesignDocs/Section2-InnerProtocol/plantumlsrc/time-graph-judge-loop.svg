<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="871px" preserveAspectRatio="none" style="width:665px;height:871px;" version="1.1" viewBox="0 0 665 871" width="665px" zoomAndPan="magnify"><defs><filter height="300%" id="f299q511iccis" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><rect fill="#FFFFFF" filter="url(#f299q511iccis)" height="506.2969" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="52" y="201.0156"/><rect fill="#FFFFFF" filter="url(#f299q511iccis)" height="55.7031" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="138" y="303.4219"/><rect fill="#FFFFFF" filter="url(#f299q511iccis)" height="230.2969" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="245" y="405.3125"/><rect fill="#FFFFFF" filter="url(#f299q511iccis)" height="30.3516" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="446" y="537.5547"/><rect fill="#FFFFFF" filter="url(#f299q511iccis)" height="661.4063" style="stroke: #000000; stroke-width: 2.0;" width="641" x="13" y="104.6094"/><rect fill="#FFFFFF" filter="url(#f299q511iccis)" height="325.1875" style="stroke: #000000; stroke-width: 2.0;" width="501" x="23" y="318.4219"/><rect fill="#FFFFFF" height="276.4844" style="stroke: none; stroke-width: 1.0;" width="501" x="23" y="367.125"/><rect fill="#FFFFFF" filter="url(#f299q511iccis)" height="155.5938" style="stroke: #000000; stroke-width: 2.0;" width="319" x="195" y="450.6641"/><rect fill="#FFFFFF" height="106.8906" style="stroke: none; stroke-width: 1.0;" width="319" x="195" y="499.3672"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="57" x2="57" y1="87.6094" y2="783.0156"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="143" x2="143" y1="87.6094" y2="783.0156"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="250" x2="250" y1="87.6094" y2="783.0156"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="357" x2="357" y1="87.6094" y2="783.0156"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="451" x2="451" y1="87.6094" y2="783.0156"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="42" x="33" y="84.5332">评测机</text><ellipse cx="57" cy="13" fill="#FEFECE" filter="url(#f299q511iccis)" rx="8" ry="8" style="stroke: #A80036; stroke-width: 2.0;"/><path d="M57,21 L57,48 M44,29 L70,29 M57,48 L44,63 M57,48 L70,63 " fill="none" filter="url(#f299q511iccis)" style="stroke: #A80036; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="42" x="33" y="796.5488">评测机</text><ellipse cx="57" cy="809.625" fill="#FEFECE" filter="url(#f299q511iccis)" rx="8" ry="8" style="stroke: #A80036; stroke-width: 2.0;"/><path d="M57,817.625 L57,844.625 M44,825.625 L70,825.625 M57,844.625 L44,859.625 M57,844.625 L70,859.625 " fill="none" filter="url(#f299q511iccis)" style="stroke: #A80036; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="70" x="105" y="84.5332">评测机缓存</text><path d="M125,34 C125,24 143,24 143,24 C143,24 161,24 161,34 L161,60 C161,70 143,70 143,70 C143,70 125,70 125,60 L125,34 " fill="#FEFECE" filter="url(#f299q511iccis)" style="stroke: #000000; stroke-width: 1.5;"/><path d="M125,34 C125,44 143,44 143,44 C143,44 161,44 161,34 " fill="none" style="stroke: #000000; stroke-width: 1.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="70" x="105" y="796.5488">评测机缓存</text><path d="M125,809.625 C125,799.625 143,799.625 143,799.625 C143,799.625 161,799.625 161,809.625 L161,835.625 C161,845.625 143,845.625 143,845.625 C143,845.625 125,845.625 125,835.625 L125,809.625 " fill="#FEFECE" filter="url(#f299q511iccis)" style="stroke: #000000; stroke-width: 1.5;"/><path d="M125,809.625 C125,819.625 143,819.625 143,819.625 C143,819.625 161,819.625 161,809.625 " fill="none" style="stroke: #000000; stroke-width: 1.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="84" x="205" y="84.5332">评测机控制端</text><ellipse cx="250" cy="54" fill="#FEFECE" filter="url(#f299q511iccis)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><polygon fill="#A80036" points="246,42,252,37,250,42,252,47,246,42" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="84" x="205" y="796.5488">评测机控制端</text><ellipse cx="250" cy="815.625" fill="#FEFECE" filter="url(#f299q511iccis)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><polygon fill="#A80036" points="246,803.625,252,798.625,250,803.625,252,808.625,246,803.625" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="56" x="326" y="84.5332">后端缓存</text><path d="M339,34 C339,24 357,24 357,24 C357,24 375,24 375,34 L375,60 C375,70 357,70 357,70 C357,70 339,70 339,60 L339,34 " fill="#FEFECE" filter="url(#f299q511iccis)" style="stroke: #000000; stroke-width: 1.5;"/><path d="M339,34 C339,44 357,44 357,44 C357,44 375,44 375,34 " fill="none" style="stroke: #000000; stroke-width: 1.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="56" x="326" y="796.5488">后端缓存</text><path d="M339,809.625 C339,799.625 357,799.625 357,799.625 C357,799.625 375,799.625 375,809.625 L375,835.625 C375,845.625 357,845.625 357,845.625 C357,845.625 339,845.625 339,835.625 L339,809.625 " fill="#FEFECE" filter="url(#f299q511iccis)" style="stroke: #000000; stroke-width: 1.5;"/><path d="M339,809.625 C339,819.625 357,819.625 357,819.625 C357,819.625 375,819.625 375,809.625 " fill="none" style="stroke: #000000; stroke-width: 1.5;"/><rect fill="#FEFECE" filter="url(#f299q511iccis)" height="31.6094" style="stroke: #A80036; stroke-width: 1.5;" width="98" x="402" y="47"/><rect fill="#FEFECE" filter="url(#f299q511iccis)" height="31.6094" style="stroke: #A80036; stroke-width: 1.5;" width="98" x="398" y="51"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="84" x="405" y="72.5332">后端文件系统</text><rect fill="#FEFECE" filter="url(#f299q511iccis)" height="31.6094" style="stroke: #A80036; stroke-width: 1.5;" width="98" x="402" y="782.0156"/><rect fill="#FEFECE" filter="url(#f299q511iccis)" height="31.6094" style="stroke: #A80036; stroke-width: 1.5;" width="98" x="398" y="786.0156"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="84" x="405" y="807.5488">后端文件系统</text><rect fill="#FFFFFF" filter="url(#f299q511iccis)" height="506.2969" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="52" y="201.0156"/><rect fill="#FFFFFF" filter="url(#f299q511iccis)" height="55.7031" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="138" y="303.4219"/><rect fill="#FFFFFF" filter="url(#f299q511iccis)" height="230.2969" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="245" y="405.3125"/><rect fill="#FFFFFF" filter="url(#f299q511iccis)" height="30.3516" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="446" y="537.5547"/><path d="M13,104.6094 L86,104.6094 L86,112.6094 L76,122.6094 L13,122.6094 L13,104.6094 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="661.4063" style="stroke: #000000; stroke-width: 2.0;" width="641" x="13" y="104.6094"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="28" x="28" y="119.1045">loop</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="52" x="101" y="118.0283">[评测循环]</text><polygon fill="#FBFB77" filter="url(#f299q511iccis)" points="209,127.9609,291,127.9609,301,139.9609,291,151.9609,209,151.9609,199,139.9609,209,127.9609" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="78" x="211" y="145.4561">选取一个令牌</text><polygon fill="#A80036" points="73,197.0156,63,201.0156,73,205.0156,69,201.0156" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="67" x2="249" y1="201.0156" y2="201.0156"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="169" x="79" y="196.1592">发送任务给令牌对应的评测机</text><path d="M255,162.3125 L255,221.3125 L630,221.3125 L630,172.3125 L620,162.3125 L255,162.3125 " fill="#FBFB77" filter="url(#f299q511iccis)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M620,162.3125 L620,172.3125 L630,172.3125 L620,162.3125 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="233" x="261" y="180.8076">包含不可缓存内容和可缓存内容的handle</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="286" x="261" y="197.1592">比如用户代码，时空限制等不能或不必缓存的内容</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="354" x="261" y="213.5107">spj代码，题目输入输出等可缓存内容发送handle（带版本号）</text><polygon fill="#FBFB77" filter="url(#f299q511iccis)" points="196,235.3672,304,235.3672,314,255.3672,304,275.3672,196,275.3672,186,255.3672,196,235.3672" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="104" x="198" y="252.8623">将令牌和任务放入</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="78" x="198" y="269.2139">活动任务队列</text><polygon fill="#A80036" points="126,299.4219,136,303.4219,126,307.4219,130,303.4219" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="62" x2="132" y1="303.4219" y2="303.4219"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="52" x="69" y="298.5654">查询缓存</text><path d="M23,318.4219 L84,318.4219 L84,326.4219 L74,336.4219 L23,336.4219 L23,318.4219 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="325.1875" style="stroke: #000000; stroke-width: 2.0;" width="501" x="23" y="318.4219"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="16" x="38" y="332.917">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="22" x="99" y="331.8408">[Hit]</text><polygon fill="#A80036" points="73,355.125,63,359.125,73,363.125,69,359.125" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="67" x2="142" y1="359.125" y2="359.125"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="52" x="79" y="354.2686">返回数据</text><line style="stroke: #000000; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="23" x2="524" y1="368.125" y2="368.125"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="35" x="28" y="379.5439">[Miss]</text><polygon fill="#A80036" points="233,401.3125,243,405.3125,233,405.3125" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="62" x2="244" y1="405.3125" y2="405.3125"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="91" x="69" y="400.4561">请求缺失的数据</text><polygon fill="#A80036" points="345,431.6641,355,435.6641,345,439.6641,349,435.6641" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="255" x2="351" y1="435.6641" y2="435.6641"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="52" x="262" y="430.8076">查询缓存</text><path d="M195,450.6641 L256,450.6641 L256,458.6641 L246,468.6641 L195,468.6641 L195,450.6641 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="155.5938" style="stroke: #000000; stroke-width: 2.0;" width="319" x="195" y="450.6641"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="16" x="210" y="465.1592">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="22" x="271" y="464.083">[Hit]</text><polygon fill="#A80036" points="266,487.3672,256,491.3672,266,495.3672,262,491.3672" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="260" x2="356" y1="491.3672" y2="491.3672"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="78" x="272" y="486.5107">返回缓存数据</text><line style="stroke: #000000; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="195" x2="514" y1="500.3672" y2="500.3672"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="35" x="200" y="511.7861">[Miss]</text><polygon fill="#A80036" points="434,533.5547,444,537.5547,434,541.5547,438,537.5547" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="255" x2="440" y1="537.5547" y2="537.5547"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="52" x="262" y="532.6982">读取文件</text><polygon fill="#A80036" points="266,563.9063,256,567.9063,266,571.9063,262,567.9063" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="260" x2="450" y1="567.9063" y2="567.9063"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="52" x="272" y="563.0498">获得数据</text><polygon fill="#A80036" points="345,594.2578,355,598.2578,345,602.2578,349,598.2578" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="255" x2="351" y1="598.2578" y2="598.2578"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="52" x="262" y="593.4014">写入缓存</text><polygon fill="#A80036" points="73,631.6094,63,635.6094,73,635.6094" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="62" x2="249" y1="635.6094" y2="635.6094"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="52" x="79" y="630.7529">返回数据</text><polygon fill="#FBFB77" filter="url(#f299q511iccis)" points="42,655.6094,72,655.6094,82,667.6094,72,679.6094,42,679.6094,32,667.6094,42,655.6094" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="26" x="44" y="673.1045">评测</text><polygon fill="#A80036" points="238,703.3125,248,707.3125,238,711.3125,242,707.3125" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="57" x2="244" y1="707.3125" y2="707.3125"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="78" x="64" y="702.4561">返回评测结果</text><polygon fill="#FBFB77" filter="url(#f299q511iccis)" points="222,720.3125,278,720.3125,288,740.3125,278,760.3125,222,760.3125,212,740.3125,222,720.3125" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="52" x="224" y="737.8076">回收任务</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="52" x="224" y="754.1592">生成令牌</text><!--MD5=[ab2168bf7613ffdc3d53a4ea5e41d658]
@startuml
scale 1
actor "评测机" as j
database "评测机缓存" as jb
control "评测机控制端" as b
database "后端缓存" as bb
collections "后端文件系统" as bfs
loop 评测循环
hnote over b : 选取一个令牌
j <- - b : 发送任务给令牌对应的评测机
hnote over b : 将令牌和任务放入\n活动任务队列
activate j
note right
包含不可缓存内容和可缓存内容的handle
比如用户代码，时空限制等不能或不必缓存的内容
spj代码，题目输入输出等可缓存内容发送handle（带版本号）
endnote
j - -> jb : 查询缓存
activate jb
alt Hit
jb - -> j : 返回数据
deactivate jb
else Miss
j - -\ b : 请求缺失的数据
activate b
b - -> bb : 查询缓存
alt Hit
bb - -> b : 返回缓存数据
else Miss
b - -> bfs : 读取文件
activate bfs
bfs - -> b : 获得数据
deactivate bfs
b - -> bb : 写入缓存
end
b - -\ j : 返回数据
deactivate b
end
hnote over j : 评测
j - -> b : 返回评测结果
hnote over b : 回收任务\n生成令牌
deactivate j
end
@enduml

PlantUML version 1.2020.01(Mon Feb 17 01:40:32 CST 2020)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Java Version: 14+36-1461
Operating System: Windows 10
Default Encoding: UTF8
Language: zh
Country: CN
--></g></svg>