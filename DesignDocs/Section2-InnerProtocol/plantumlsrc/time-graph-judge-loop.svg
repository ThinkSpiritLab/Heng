<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="969px" preserveAspectRatio="none" style="width:602px;height:969px;" version="1.1" viewBox="0 0 602 969" width="602px" zoomAndPan="magnify"><defs><filter height="300%" id="f1d6fuogua6uwv" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><rect fill="#FFFFFF" filter="url(#f1d6fuogua6uwv)" height="522.9766" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="62" y="282.0703"/><rect fill="#FFFFFF" filter="url(#f1d6fuogua6uwv)" height="77.7031" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="148" y="389.4766"/><rect fill="#FFFFFF" filter="url(#f1d6fuogua6uwv)" height="30.3516" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="355" y="545.2344"/><rect fill="#FFFFFF" filter="url(#f1d6fuogua6uwv)" height="759.1406" style="stroke: #000000; stroke-width: 2.0;" width="578" x="13" y="104.6094"/><rect fill="#FFFFFF" filter="url(#f1d6fuogua6uwv)" height="141.7578" style="stroke: #000000; stroke-width: 2.0;" width="292" x="23" y="318.4219"/><rect fill="#FFFFFF" filter="url(#f1d6fuogua6uwv)" height="48.7031" style="stroke: #000000; stroke-width: 2.0;" width="168" x="33" y="404.4766"/><rect fill="#FFFFFF" filter="url(#f1d6fuogua6uwv)" height="172.1094" style="stroke: #000000; stroke-width: 2.0;" width="392" x="23" y="474.1797"/><rect fill="#FFFFFF" filter="url(#f1d6fuogua6uwv)" height="48.7031" style="stroke: #000000; stroke-width: 2.0;" width="168" x="33" y="590.5859"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="67" x2="67" y1="87.6094" y2="880.75"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="153" x2="153" y1="87.6094" y2="880.75"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="260" x2="260" y1="87.6094" y2="880.75"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="360" x2="360" y1="87.6094" y2="880.75"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="42" x="43" y="84.5332">评测机</text><ellipse cx="67" cy="13" fill="#FEFECE" filter="url(#f1d6fuogua6uwv)" rx="8" ry="8" style="stroke: #A80036; stroke-width: 2.0;"/><path d="M67,21 L67,48 M54,29 L80,29 M67,48 L54,63 M67,48 L80,63 " fill="none" filter="url(#f1d6fuogua6uwv)" style="stroke: #A80036; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="42" x="43" y="894.2832">评测机</text><ellipse cx="67" cy="907.3594" fill="#FEFECE" filter="url(#f1d6fuogua6uwv)" rx="8" ry="8" style="stroke: #A80036; stroke-width: 2.0;"/><path d="M67,915.3594 L67,942.3594 M54,923.3594 L80,923.3594 M67,942.3594 L54,957.3594 M67,942.3594 L80,957.3594 " fill="none" filter="url(#f1d6fuogua6uwv)" style="stroke: #A80036; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="70" x="115" y="84.5332">评测机缓存</text><path d="M135,34 C135,24 153,24 153,24 C153,24 171,24 171,34 L171,60 C171,70 153,70 153,70 C153,70 135,70 135,60 L135,34 " fill="#FEFECE" filter="url(#f1d6fuogua6uwv)" style="stroke: #000000; stroke-width: 1.5;"/><path d="M135,34 C135,44 153,44 153,44 C153,44 171,44 171,34 " fill="none" style="stroke: #000000; stroke-width: 1.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="70" x="115" y="894.2832">评测机缓存</text><path d="M135,907.3594 C135,897.3594 153,897.3594 153,897.3594 C153,897.3594 171,897.3594 171,907.3594 L171,933.3594 C171,943.3594 153,943.3594 153,943.3594 C153,943.3594 135,943.3594 135,933.3594 L135,907.3594 " fill="#FEFECE" filter="url(#f1d6fuogua6uwv)" style="stroke: #000000; stroke-width: 1.5;"/><path d="M135,907.3594 C135,917.3594 153,917.3594 153,917.3594 C153,917.3594 171,917.3594 171,907.3594 " fill="none" style="stroke: #000000; stroke-width: 1.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="84" x="215" y="84.5332">评测机控制端</text><ellipse cx="260" cy="54" fill="#FEFECE" filter="url(#f1d6fuogua6uwv)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><polygon fill="#A80036" points="256,42,262,37,260,42,262,47,256,42" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="84" x="215" y="894.2832">评测机控制端</text><ellipse cx="260" cy="913.3594" fill="#FEFECE" filter="url(#f1d6fuogua6uwv)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><polygon fill="#A80036" points="256,901.3594,262,896.3594,260,901.3594,262,906.3594,256,901.3594" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="84" x="315" y="84.5332">题目文件存储</text><path d="M342,34 C342,24 360,24 360,24 C360,24 378,24 378,34 L378,60 C378,70 360,70 360,70 C360,70 342,70 342,60 L342,34 " fill="#FEFECE" filter="url(#f1d6fuogua6uwv)" style="stroke: #000000; stroke-width: 1.5;"/><path d="M342,34 C342,44 360,44 360,44 C360,44 378,44 378,34 " fill="none" style="stroke: #000000; stroke-width: 1.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="84" x="315" y="894.2832">题目文件存储</text><path d="M342,907.3594 C342,897.3594 360,897.3594 360,897.3594 C360,897.3594 378,897.3594 378,907.3594 L378,933.3594 C378,943.3594 360,943.3594 360,943.3594 C360,943.3594 342,943.3594 342,933.3594 L342,907.3594 " fill="#FEFECE" filter="url(#f1d6fuogua6uwv)" style="stroke: #000000; stroke-width: 1.5;"/><path d="M342,907.3594 C342,917.3594 360,917.3594 360,917.3594 C360,917.3594 378,917.3594 378,907.3594 " fill="none" style="stroke: #000000; stroke-width: 1.5;"/><rect fill="#FFFFFF" filter="url(#f1d6fuogua6uwv)" height="522.9766" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="62" y="282.0703"/><rect fill="#FFFFFF" filter="url(#f1d6fuogua6uwv)" height="77.7031" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="148" y="389.4766"/><rect fill="#FFFFFF" filter="url(#f1d6fuogua6uwv)" height="30.3516" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="355" y="545.2344"/><path d="M13,104.6094 L86,104.6094 L86,112.6094 L76,122.6094 L13,122.6094 L13,104.6094 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="759.1406" style="stroke: #000000; stroke-width: 2.0;" width="578" x="13" y="104.6094"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="28" x="28" y="119.1045">loop</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="52" x="101" y="118.0283">[评测循环]</text><polygon fill="#FBFB77" filter="url(#f1d6fuogua6uwv)" points="219,127.9609,301,127.9609,311,139.9609,301,151.9609,219,151.9609,209,139.9609,219,127.9609" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="78" x="221" y="145.4561">选取一个令牌</text><polygon fill="#A80036" points="78,175.6641,68,179.6641,78,183.6641,74,179.6641" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="72" x2="259" y1="179.6641" y2="179.6641"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="169" x="84" y="174.8076">发送任务给令牌对应的评测机</text><polygon fill="#FBFB77" filter="url(#f1d6fuogua6uwv)" points="206,192.6641,314,192.6641,324,212.6641,314,232.6641,206,232.6641,196,212.6641,206,192.6641" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="104" x="208" y="210.1592">将令牌和任务放入</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="78" x="208" y="226.5107">活动任务队列</text><polygon fill="#A80036" points="248,278.0703,258,282.0703,248,282.0703" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="72" x2="259" y1="282.0703" y2="282.0703"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="65" x="79" y="277.2139">任务准备中</text><path d="M265,243.3672 L265,302.3672 L572,302.3672 L572,253.3672 L562,243.3672 L265,243.3672 " fill="#FBFB77" filter="url(#f1d6fuogua6uwv)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M562,243.3672 L562,253.3672 L572,253.3672 L562,243.3672 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="220" x="271" y="261.8623">包含不可缓存内容和可缓存内容的URL</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="286" x="271" y="278.2139">比如用户代码，时空限制等不能或不必缓存的内容</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="263" x="271" y="294.5654">spj代码，题目输入输出等可缓存内容发送URL</text><path d="M23,318.4219 L96,318.4219 L96,326.4219 L86,336.4219 L23,336.4219 L23,318.4219 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="141.7578" style="stroke: #000000; stroke-width: 2.0;" width="292" x="23" y="318.4219"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="28" x="38" y="332.917">loop</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="78" x="111" y="331.8408">[Query Cahce]</text><polygon fill="#A80036" points="248,355.125,258,359.125,248,359.125" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="72" x2="259" y1="359.125" y2="359.125"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="104" x="79" y="354.2686">任务正在查询缓存</text><polygon fill="#A80036" points="136,385.4766,146,389.4766,136,393.4766,140,389.4766" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="72" x2="142" y1="389.4766" y2="389.4766"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="52" x="79" y="384.6201">查询缓存</text><path d="M33,404.4766 L94,404.4766 L94,412.4766 L84,422.4766 L33,422.4766 L33,404.4766 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="48.7031" style="stroke: #000000; stroke-width: 2.0;" width="168" x="33" y="404.4766"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="16" x="48" y="418.9717">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="59" x="109" y="417.8955">[Cache Hit]</text><polygon fill="#A80036" points="83,441.1797,73,445.1797,83,449.1797,79,445.1797" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="77" x2="147" y1="445.1797" y2="445.1797"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="52" x="89" y="440.3232">返回数据</text><path d="M23,474.1797 L84,474.1797 L84,482.1797 L74,492.1797 L23,492.1797 L23,474.1797 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="172.1094" style="stroke: #000000; stroke-width: 2.0;" width="392" x="23" y="474.1797"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="16" x="38" y="488.6748">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="70" x="99" y="487.5986">[Not Cached]</text><polygon fill="#A80036" points="248,510.8828,258,514.8828,248,514.8828" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="72" x2="259" y1="514.8828" y2="514.8828"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="104" x="79" y="510.0264">任务正在下载数据</text><polygon fill="#A80036" points="343,541.2344,353,545.2344,343,545.2344" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="72" x2="354" y1="545.2344" y2="545.2344"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="91" x="79" y="540.3779">请求缺失的数据</text><polygon fill="#A80036" points="83,571.5859,73,575.5859,83,575.5859" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="72" x2="359" y1="575.5859" y2="575.5859"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="52" x="89" y="570.7295">返回数据</text><path d="M33,590.5859 L94,590.5859 L94,598.5859 L84,608.5859 L33,608.5859 L33,590.5859 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="48.7031" style="stroke: #000000; stroke-width: 2.0;" width="168" x="33" y="590.5859"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="16" x="48" y="605.0811">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="42" x="109" y="604.0049">[Cache]</text><polygon fill="#A80036" points="141,627.2891,151,631.2891,141,635.2891,145,631.2891" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="72" x2="147" y1="631.2891" y2="631.2891"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="52" x="79" y="626.4326">写入缓存</text><polygon fill="#A80036" points="248,671.6406,258,675.6406,248,675.6406" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="72" x2="259" y1="675.6406" y2="675.6406"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="104" x="79" y="670.7842">任务正在等待评测</text><polygon fill="#FBFB77" filter="url(#f1d6fuogua6uwv)" points="52,688.6406,82,688.6406,92,700.6406,82,712.6406,52,712.6406,42,700.6406,52,688.6406" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="26" x="54" y="706.1357">评测</text><polygon fill="#A80036" points="248,736.3438,258,740.3438,248,740.3438" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="72" x2="259" y1="740.3438" y2="740.3438"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="78" x="79" y="735.4873">任务正在评测</text><polygon fill="#FBFB77" filter="url(#f1d6fuogua6uwv)" points="39,753.3438,95,753.3438,105,765.3438,95,777.3438,39,777.3438,29,765.3438,39,753.3438" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="52" x="41" y="770.8389">评测结束</text><polygon fill="#A80036" points="248,801.0469,258,805.0469,248,809.0469,252,805.0469" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="67" x2="254" y1="805.0469" y2="805.0469"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="78" x="74" y="800.1904">返回评测结果</text><polygon fill="#FBFB77" filter="url(#f1d6fuogua6uwv)" points="232,818.0469,288,818.0469,298,838.0469,288,858.0469,232,858.0469,222,838.0469,232,818.0469" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="52" x="234" y="835.542">回收任务</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="52" x="234" y="851.8936">生成令牌</text><!--MD5=[3f57831b5d49a014be95c9f4dc6ff355]
@startuml
scale 1
actor "评测机" as j
database "评测机缓存" as jb
control "评测机控制端" as b
database "题目文件存储" as oss
loop 评测循环
hnote over b : 选取一个令牌
j <- - b : 发送任务给令牌对应的评测机
hnote over b : 将令牌和任务放入\n活动任务队列
j - -\ b : 任务准备中
activate j
note right
包含不可缓存内容和可缓存内容的URL
比如用户代码，时空限制等不能或不必缓存的内容
spj代码，题目输入输出等可缓存内容发送URL
endnote
loop Query Cahce
j - -\ b : 任务正在查询缓存
j - -> jb : 查询缓存
activate jb
alt Cache Hit
jb - -> j : 返回数据
end
end
deactivate jb
alt Not Cached
j - -\ b : 任务正在下载数据
j - -\ oss : 请求缺失的数据
activate oss
oss - -\ j : 返回数据
deactivate oss
alt Cache
j - -> jb : 写入缓存
end
end
j - -\ b : 任务正在等待评测
hnote over j : 评测
j - -\ b : 任务正在评测
hnote over j : 评测结束
j - -> b : 返回评测结果
hnote over b : 回收任务\n生成令牌
deactivate j
end
@enduml

PlantUML version 1.2020.01(Mon Feb 17 01:40:32 CST 2020)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Java Version: 14+36-1461
Operating System: Windows 10
Default Encoding: UTF8
Language: zh
Country: CN
--></g></svg>